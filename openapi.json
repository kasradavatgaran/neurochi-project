{"openapi":"3.1.0","info":{"title":"Nerochi API","version":"0.1.0"},"paths":{"/request-otp":{"post":{"tags":["Authentication"],"summary":"Request Otp","description":"یک کد OTP تولید کرده، آن را در دیتابیس ذخیره و از طریق SMS ارسال می‌کند.","operationId":"request_otp_request_otp_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserCreate"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/verify-otp":{"post":{"tags":["Authentication"],"summary":"Verify Otp","description":"کد OTP دریافت شده را تایید کرده و وضعیت کاربر (جدید یا قدیمی) را برمی‌گرداند.","operationId":"verify_otp_verify_otp_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/OtpVerify"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/me/{phone_number}":{"get":{"tags":["Profile"],"summary":"Get User Profile","description":"اطلاعات کامل یک کاربر و تمام فرزندانش را برمی‌گرداند.","operationId":"get_user_profile_me__phone_number__get","parameters":[{"name":"phone_number","in":"path","required":true,"schema":{"type":"string","title":"Phone Number"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/users/{phone_number}":{"put":{"tags":["Profile"],"summary":"Update User Profile","description":"نام پروفایل والد را ویرایش می‌کند.","operationId":"update_user_profile_users__phone_number__put","parameters":[{"name":"phone_number","in":"path","required":true,"schema":{"type":"string","title":"Phone Number"}},{"name":"parent_name","in":"query","required":true,"schema":{"type":"string","title":"Parent Name"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/users/{phone_number}/upload-profile-image":{"post":{"tags":["Profile"],"summary":"Upload Profile Image","description":"عکس پروفایل کاربر را آپلود و آدرس آن را در دیتابیس ذخیره می‌کند.","operationId":"upload_profile_image_users__phone_number__upload_profile_image_post","parameters":[{"name":"phone_number","in":"path","required":true,"schema":{"type":"string","title":"Phone Number"}}],"requestBody":{"required":true,"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_upload_profile_image_users__phone_number__upload_profile_image_post"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/create-profile":{"post":{"tags":["Profile"],"summary":"Create Profile","description":"برای کاربر جدید، پروفایل والد و اولین فرزند را ایجاد می‌کند.","operationId":"create_profile_create_profile_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/FullProfileCreate"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/children":{"post":{"tags":["Children"],"summary":"Add Child","operationId":"add_child_children_post","parameters":[{"name":"phone_number","in":"query","required":true,"schema":{"type":"string","title":"Phone Number"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChildCreate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChildResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/children/{child_id}":{"put":{"tags":["Children"],"summary":"Update Child","description":"اطلاعات یک فرزند موجود را ویرایش می‌کند.","operationId":"update_child_children__child_id__put","parameters":[{"name":"child_id","in":"path","required":true,"schema":{"type":"integer","title":"Child Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChildCreate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChildResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["Children"],"summary":"Delete Child","description":"یک فرزند را از دیتابیس حذف می‌کند.","operationId":"delete_child_children__child_id__delete","parameters":[{"name":"child_id","in":"path","required":true,"schema":{"type":"integer","title":"Child Id"}}],"responses":{"204":{"description":"Successful Response"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/chat":{"post":{"tags":["Chat"],"summary":"Handle Chat","operationId":"handle_chat_chat_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChatRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/children/{child_id}/growth-analysis":{"get":{"tags":["Growth Analysis"],"summary":"Get Growth Analysis","description":"تحلیل رشد کودک را بر اساس آخرین رکورد ثبت شده و استانداردهای WHO برمی‌گرداند.","operationId":"get_growth_analysis_children__child_id__growth_analysis_get","parameters":[{"name":"child_id","in":"path","required":true,"schema":{"type":"integer","title":"Child Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/children/{child_id}/suggested-tests":{"get":{"tags":["Skill Tests"],"summary":"Get Suggested Tests","description":"لیست تست‌های پیشنهادی برای سن کودک را با فیلتر زمان انجام مجدد برمی‌گرداند.","operationId":"get_suggested_tests_children__child_id__suggested_tests_get","parameters":[{"name":"child_id","in":"path","required":true,"schema":{"type":"integer","title":"Child Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/SuggestedTest"},"title":"Response Get Suggested Tests Children  Child Id  Suggested Tests Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/tests/answer":{"post":{"tags":["Skill Tests"],"summary":"Submit Test Answer","operationId":"submit_test_answer_tests_answer_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/TestAnswerRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CurrentQuestionResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/children/{child_id}/suggested-games":{"get":{"tags":["Games"],"summary":"Get Suggested Games","description":"۵ بازی تصادفی را پیشنهاد می‌دهد. اگر در ۷ روز گذشته بازی انجام شده باشد، قفل می‌شود.","operationId":"get_suggested_games_children__child_id__suggested_games_get","parameters":[{"name":"child_id","in":"path","required":true,"schema":{"type":"integer","title":"Child Id"}},{"name":"skill_category","in":"query","required":true,"schema":{"type":"string","title":"Skill Category"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuggestedGamesResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/games/answer":{"post":{"tags":["Games"],"summary":"Submit Game Answer","description":"پاسخ کاربر به یک بازی را در دیتابیس ذخیره می‌کند.","operationId":"submit_game_answer_games_answer_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/GameAnswerRequest"}}},"required":true},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/children/{child_id}/final-analysis":{"get":{"tags":["Analysis"],"summary":"Get Final Analysis For Skill","description":"تاریخچه تست و بازی‌های یک مهارت را جمع‌آوری کرده،\nآن را با اطلاعات علمی از اسناد (RAG) غنی کرده و برای تحلیل نهایی به Gemini ارسال می‌کند.","operationId":"get_final_analysis_for_skill_children__child_id__final_analysis_get","parameters":[{"name":"child_id","in":"path","required":true,"schema":{"type":"integer","title":"Child Id"}},{"name":"skill_category","in":"query","required":true,"schema":{"type":"string","title":"Skill Category"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/transcribe-audio":{"post":{"tags":["Chat"],"summary":"Handle Audio Upload","description":"فایل صوتی را از فرانت‌اند دریافت، ذخیره، به متن تبدیل کرده و سپس مانند یک پیام متنی عادی پردازش می‌کند.","operationId":"handle_audio_upload_transcribe_audio_post","parameters":[{"name":"phone_number","in":"query","required":true,"schema":{"type":"string","title":"Phone Number"}},{"name":"child_id","in":"query","required":false,"schema":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Child Id"}}],"requestBody":{"required":true,"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_handle_audio_upload_transcribe_audio_post"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/text-to-speech":{"post":{"tags":["TTS"],"summary":"Text To Speech Handler","description":"متن ورودی را به صوت تبدیل کرده و آدرس فایل صوتی را برمی‌گرداند.","operationId":"text_to_speech_handler_text_to_speech_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/TTSRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/children/{child_id}/growth-records":{"post":{"tags":["Growth Analysis"],"summary":"Add Growth Record","description":"یک رکورد رشد جدید (قد، وزن و...) برای کودک ثبت می‌کند.","operationId":"add_growth_record_children__child_id__growth_records_post","parameters":[{"name":"child_id","in":"path","required":true,"schema":{"type":"integer","title":"Child Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/GrowthRecordCreate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/GrowthRecordResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/children/{child_id}/growth-chart":{"get":{"tags":["Growth Analysis"],"summary":"Get Growth Chart Data","description":"داده‌های نمودار و تحلیل هوشمند بر اساس جدول منطقی ارائه شده.","operationId":"get_growth_chart_data_children__child_id__growth_chart_get","parameters":[{"name":"child_id","in":"path","required":true,"schema":{"type":"integer","title":"Child Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/GrowthChartResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/tests/previous":{"post":{"tags":["Skill Tests"],"summary":"Go To Previous Question","description":"وضعیت تست را یک مرحله به عقب برمی‌گرداند و پاسخ قبلی را حذف می‌کند.","operationId":"go_to_previous_question_tests_previous_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/TestPreviousRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/QuestionResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/chat/history/{phone_number}/{child_id}":{"get":{"tags":["Chat"],"summary":"Get Chat History","description":"تاریخچه مکالمات مربوط به یک کاربر و یک فرزند خاص را برمی‌گرداند.","operationId":"get_chat_history_chat_history__phone_number___child_id__get","parameters":[{"name":"phone_number","in":"path","required":true,"schema":{"type":"string","title":"Phone Number"}},{"name":"child_id","in":"path","required":true,"schema":{"type":"integer","title":"Child Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/ChatMessageResponse"},"title":"Response Get Chat History Chat History  Phone Number   Child Id  Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}}},"components":{"schemas":{"Body_handle_audio_upload_transcribe_audio_post":{"properties":{"file":{"type":"string","format":"binary","title":"File"}},"type":"object","required":["file"],"title":"Body_handle_audio_upload_transcribe_audio_post"},"Body_upload_profile_image_users__phone_number__upload_profile_image_post":{"properties":{"file":{"type":"string","format":"binary","title":"File"}},"type":"object","required":["file"],"title":"Body_upload_profile_image_users__phone_number__upload_profile_image_post"},"ChatMessageResponse":{"properties":{"id":{"type":"integer","title":"Id"},"role":{"type":"string","title":"Role"},"content":{"type":"string","title":"Content"},"timestamp":{"type":"string","format":"date-time","title":"Timestamp"}},"type":"object","required":["id","role","content","timestamp"],"title":"ChatMessageResponse"},"ChatRequest":{"properties":{"phone_number":{"type":"string","title":"Phone Number"},"message":{"type":"string","title":"Message"},"child_id":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Child Id"}},"type":"object","required":["phone_number","message"],"title":"ChatRequest"},"ChildCreate":{"properties":{"name":{"type":"string","title":"Name"},"birth_date":{"type":"string","format":"date","title":"Birth Date"},"gender":{"type":"string","title":"Gender"},"gestation_week":{"type":"integer","title":"Gestation Week"},"birth_height":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Birth Height","description":"قد در زمان تولد به سانتی‌متر"},"birth_weight":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Birth Weight","description":"وزن در زمان تولد به کیلوگرم"},"birth_head_circumference":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Birth Head Circumference","description":"دور سر در زمان تولد به سانتی‌متر"}},"type":"object","required":["name","birth_date","gender","gestation_week"],"title":"ChildCreate"},"ChildResponse":{"properties":{"name":{"type":"string","title":"Name"},"birth_date":{"type":"string","format":"date","title":"Birth Date"},"gender":{"type":"string","title":"Gender"},"id":{"type":"integer","title":"Id"},"has_conversation_started":{"type":"boolean","title":"Has Conversation Started"},"growth_records":{"items":{"$ref":"#/components/schemas/GrowthRecordResponse"},"type":"array","title":"Growth Records","default":[]}},"type":"object","required":["name","birth_date","gender","id","has_conversation_started"],"title":"ChildResponse"},"CurrentQuestionResponse":{"properties":{"session_id":{"type":"integer","title":"Session Id"},"is_last_question":{"type":"boolean","title":"Is Last Question"},"question":{"anyOf":[{"$ref":"#/components/schemas/QuestionResponse"},{"type":"null"}]},"final_result":{"anyOf":[{"$ref":"#/components/schemas/FinalResultResponse"},{"type":"null"}]}},"type":"object","required":["session_id","is_last_question"],"title":"CurrentQuestionResponse"},"FinalResultResponse":{"properties":{"title":{"type":"string","title":"Title"},"score":{"type":"number","title":"Score"},"max_score":{"type":"number","title":"Max Score"},"status":{"type":"string","title":"Status"},"status_color":{"type":"string","title":"Status Color"},"suggestion":{"type":"string","title":"Suggestion"},"needs_games":{"type":"boolean","title":"Needs Games"}},"type":"object","required":["title","score","max_score","status","status_color","suggestion","needs_games"],"title":"FinalResultResponse"},"FullProfileCreate":{"properties":{"phone_number":{"type":"string","title":"Phone Number"},"parent_name":{"type":"string","title":"Parent Name"},"child":{"$ref":"#/components/schemas/ChildCreate"}},"type":"object","required":["phone_number","parent_name","child"],"title":"FullProfileCreate"},"GameAnswerRequest":{"properties":{"child_id":{"type":"integer","title":"Child Id"},"game_id":{"type":"integer","title":"Game Id"},"response":{"type":"string","title":"Response"}},"type":"object","required":["child_id","game_id","response"],"title":"GameAnswerRequest"},"GameSchema":{"properties":{"id":{"type":"integer","title":"Id"},"title":{"type":"string","title":"Title"},"description":{"type":"string","title":"Description"},"skill_category":{"type":"string","title":"Skill Category"},"image_url":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Image Url"}},"type":"object","required":["id","title","description","skill_category"],"title":"GameSchema"},"GrowthChartResponse":{"properties":{"records":{"items":{"$ref":"#/components/schemas/GrowthRecordResponse"},"type":"array","title":"Records"},"analysis":{"type":"string","title":"Analysis"}},"type":"object","required":["records","analysis"],"title":"GrowthChartResponse"},"GrowthRecordCreate":{"properties":{"height":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Height","description":"قد به سانتی‌متر"},"weight":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Weight","description":"وزن به کیلوگرم"},"head_circumference":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Head Circumference","description":"دور سر به سانتی‌متر"}},"type":"object","title":"GrowthRecordCreate"},"GrowthRecordResponse":{"properties":{"height":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Height","description":"قد به سانتی‌متر"},"weight":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Weight","description":"وزن به کیلوگرم"},"head_circumference":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Head Circumference","description":"دور سر به سانتی‌متر"},"id":{"type":"integer","title":"Id"},"date":{"type":"string","format":"date-time","title":"Date"}},"type":"object","required":["id","date"],"title":"GrowthRecordResponse"},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"OtpVerify":{"properties":{"phone_number":{"type":"string","title":"Phone Number"},"otp_code":{"type":"string","title":"Otp Code"}},"type":"object","required":["phone_number","otp_code"],"title":"OtpVerify"},"QuestionResponse":{"properties":{"id":{"type":"integer","title":"Id"},"order_index":{"type":"integer","title":"Order Index"},"text":{"type":"string","title":"Text"},"image_url":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Image Url"},"option_A":{"type":"string","title":"Option A"},"option_B":{"type":"string","title":"Option B"},"option_C":{"type":"string","title":"Option C"}},"type":"object","required":["id","order_index","text","option_A","option_B","option_C"],"title":"QuestionResponse"},"SuggestedGamesResponse":{"properties":{"status":{"type":"string","title":"Status"},"message":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Message"},"games":{"items":{"$ref":"#/components/schemas/GameSchema"},"type":"array","title":"Games","default":[]},"next_available_date":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Next Available Date"}},"type":"object","required":["status"],"title":"SuggestedGamesResponse"},"SuggestedTest":{"properties":{"skill_category":{"type":"string","title":"Skill Category"},"set_name":{"type":"string","title":"Set Name"},"is_available":{"type":"boolean","title":"Is Available"}},"type":"object","required":["skill_category","set_name","is_available"],"title":"SuggestedTest"},"TTSRequest":{"properties":{"text":{"type":"string","title":"Text"}},"type":"object","required":["text"],"title":"TTSRequest"},"TestAnswerRequest":{"properties":{"session_id":{"type":"integer","title":"Session Id"},"answer_choice":{"type":"string","title":"Answer Choice"}},"type":"object","required":["session_id","answer_choice"],"title":"TestAnswerRequest"},"TestPreviousRequest":{"properties":{"session_id":{"type":"integer","title":"Session Id"}},"type":"object","required":["session_id"],"title":"TestPreviousRequest"},"UserCreate":{"properties":{"phone_number":{"type":"string","title":"Phone Number"}},"type":"object","required":["phone_number"],"title":"UserCreate"},"UserResponse":{"properties":{"id":{"type":"integer","title":"Id"},"phone_number":{"type":"string","title":"Phone Number"},"parent_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Parent Name"},"profile_image_url":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Profile Image Url"},"children":{"items":{"$ref":"#/components/schemas/ChildResponse"},"type":"array","title":"Children","default":[]}},"type":"object","required":["id","phone_number"],"title":"UserResponse"},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"}}}}
